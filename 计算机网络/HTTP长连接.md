---
date created: 2022-07-27 11:39
---
<details><summary>目录</summary>

- [HTTP长连接](#http长连接)
- [HTTP的1.0版本](#http的10版本)
  - [短连接](#短连接)
  - [长连接](#长连接)
- [HTTP/1.1 协议支持的长连接](#http11-协议支持的长连接)
- [服务端HTTP长连接技术](#服务端http长连接技术)

</details>

# HTTP长连接
        HTTP属于 TCP/IP模型中的应用层协议，HTTP长连接和HTTP短连接，指的是 **传输层的TCP连接是否被多次使用**。
# HTTP的1.0版本
## 短连接
 默认情况下，HTTP的1.0版本协议中，HTTP在每次请求结束后都会主动释放TCP连 接，因此HTTP连接是一种“短连接”。客户端与服务端通过HTTP短连接的交互过程，具体如下图所示。
 ![](https://raw.githubusercontent.com/ParadiseWitch/Images/master/img/202207271139555.png)
在高并发场景使用HTTP“短连接”通信，会出现两个问题：
    （1）性能较差：传输层的TCP连接不会复用，每一次请求，都需要建立和拆除一次 TCP连接，也即是说，每次请求均需要TCP三次握手建立连接，TCP四次挥手关闭连接，性 能较差。
	（2）很容易出现端口被占满：在主动断开方，系统会出现大量的TIME_WAIT状态的 TCP连接，只有等2个MSL后，TCP连接才会进行关闭掉，在高并发场景中，如果服务器主动断开连接，则很容易发生端口耗尽。当然，如果连接被设置了SO_RESUSEADDR特性，其端口可能被其他连接复用，尽管如此，还是会存在不少的约束条件影响到端口复用。出于以上两个原因，在高并发场景使用HTTP“短连接”进行通信肯定是不行的。
## 长连接
HTTP长连接，也叫HTTP持久连接，指的是TCP连接建立后，该传输层连接不再进行释放，供应用层反复使用。客户端与服务端通过HTTP长连接的交互过程，具体如下图所示：
![](https://raw.githubusercontent.com/ParadiseWitch/Images/master/img/202207271140291.png)
 HTTP长连接的特点是：
    （1）性能较高，不需要重复建立TCP连接或者关闭TCP连接；
	（2）TCP数据传输连接基本上不会出现`CLOSE_WAIT`和`TIME_WAIT`的问题，系统资源的使用效率会大大提升。 HTTP长连接也有缺点：一般需要一个连接池来对可供复用的TCP长连接进行管理和监测。常见的数据库连接池、HTTP连接池，本质上都属于TCP连接池。
 # HTTP/1.1 协议支持的长连接
HTTP/1.1默认使用长连接而不是短连接，除非显式关闭TCP连接。如果要显式关闭连接，需要在HTTP报文首部加上“`Connection:Close`”请求头，也就是说在HTTP/1.1协议 中，默认情况下，所有的TCP连接都可以进行复用的。

当然，不发送“`Connection:Close`”请求头，不意味着服务器承诺TCP连接永远保持打开。空闲的TCP连接也可以被客户端与服务端关闭。

# 服务端HTTP长连接技术
服务端HTTP长连接技术主要以主流的反向代理服务器Nginx和应用服务器Tomcat的服务端长连接配置、
