---
date created: 2022-07-23 12:20
date updated: 2022-07-23 15:16
---

# 一致性哈希

tag: #一致性哈希
Links:
- [16 张图解带你掌握一致性哈希算法-华为开发者论坛](https://developer.huawei.com/consumer/cn/forum/topic/0203810951415790238?fid=0101592429757310384)

- #负载均衡 #
  - #加权轮询 ：根据<u>硬件配置</u>来决定那台服务器分配请求多。<u>无法应对「分布式系统」</u>
  - 哈希算法
    - 简单取模运算：<u>迁移麻烦</u>。最坏是O(N)。
    - #一致性哈希 ：在一致哈希算法中，如果增加或者移除一个节点，仅影响该节点在哈希环上顺时针相邻的后继节点，其它数据也不会受到影响。<u>存在节点分布不均匀的问题</u>。
      - 使用虚拟节点的一致性哈希：增加了均衡性。


# FAQ
F. 在一致性哈希中，服务器在环上的位置为什么要用hash来决定，使用hash不就不能确保均衡性了吗，不就失去灵活性了吗？
Q(maid): 
- 均衡性：
	如果不使用hash，而是使用总流量除以服务器数量的平均值来定位服务器在环上的节点位置，即假设平均值为x，服务器a在环上x的位置，服务器b的节点在2x位置，c在3x的位置，那么确实看起来保证了均衡性，每个服务器就负载来大概x的流量。
	但是，真实业务场景下，总流量是无法估计判断的，流量存在高峰和低谷，无法即使获取。没有虚拟节点的一致性哈希确实有均衡性问题，所以才需要引入虚拟节点来增强均衡性。
